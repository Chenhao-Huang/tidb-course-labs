[2023/03/26 22:51:01.360 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/26 22:51:01.361 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/26 22:51:01.361 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1679842261361658000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/26 22:51:01.362 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/26 22:51:01.368 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/26 22:51:01.368 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=450.199µs] []
[2023/03/26 22:51:01.375 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/26 22:51:01.375 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/26 22:51:01.375 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/26 22:51:01.377 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/26 22:51:01.776 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:51:04.061 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=2.684235476s] []
[2023/03/26 22:51:04.062 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:51:04.090 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/26 22:51:04.099 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/26 22:51:04.100 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`sal`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`sal`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`t`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`t`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=55.165µs]
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`sal`] [enginesCnt=2] [filesCnt=1] [takeTime=92.215µs] []
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/26 22:51:04.100 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=31.781µs]
[2023/03/26 22:51:04.100 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=71.224µs]
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=61.349µs] []
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`t`] [enginesCnt=2] [filesCnt=1] [takeTime=134.793µs] []
[2023/03/26 22:51:04.100 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=57.634µs]
[2023/03/26 22:51:04.100 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=88.808µs] []
[2023/03/26 22:51:04.101 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:51:04.101 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:51:04.101 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:51:04.101 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/26 22:51:04.102 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/26 22:51:04.102 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/26 22:51:04.102 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:51:04.102 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:51:04.102 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29]
[2023/03/26 22:51:04.102 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`sal`]
[2023/03/26 22:51:04.102 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:51:04.102 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`sal`] [engineNumber=0]
[2023/03/26 22:51:04.102 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`sal`] [engineNumber=0]
[2023/03/26 22:51:04.102 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f]
[2023/03/26 22:51:04.103 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:51:04.103 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/26 22:51:04.103 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/26 22:51:04.103 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/26 22:51:04.103 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:51:04.103 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000010000.sql:0]
[2023/03/26 22:51:04.103 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000010000.sql:0]
[2023/03/26 22:51:04.103 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`sal`] [engineNumber=0] [fileIndex=0] [path=emp.sal.0000000010000.sql:0]
[2023/03/26 22:51:04.103 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c]
[2023/03/26 22:51:04.103 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`t`]
[2023/03/26 22:51:04.103 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`t`] [engineNumber=0]
[2023/03/26 22:51:04.103 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`t`] [engineNumber=0]
[2023/03/26 22:51:04.103 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423]
[2023/03/26 22:51:04.104 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`t`] [engineNumber=0] [fileIndex=0] [path=emp.t.0000000010000.sql:0]
[2023/03/26 22:51:04.106 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`t`] [engineNumber=0] [fileIndex=0] [path=emp.t.0000000010000.sql:0] [readDur=198.049µs] [encodeDur=2.059µs] [deliverDur=2.168002ms] [checksum="{cksum=0,size=19,kvs=2}"] [takeTime=2.528301ms] []
[2023/03/26 22:51:04.106 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`t`] [engineNumber=0] [read=0] [written=19] [takeTime=2.744163ms] []
[2023/03/26 22:51:04.107 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423]
[2023/03/26 22:51:04.107 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423] [takeTime=545ns] []
[2023/03/26 22:51:04.107 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000010000.sql:0] [readDur=314.321µs] [encodeDur=13.896µs] [deliverDur=3.453339ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=3.865821ms] []
[2023/03/26 22:51:04.107 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=5.387447ms] []
[2023/03/26 22:51:04.107 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`t`] [engineNumber=0] [takeTime=3.873478ms] []
[2023/03/26 22:51:04.107 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423]
[2023/03/26 22:51:04.107 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423] [retryCnt=0]
[2023/03/26 22:51:04.107 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423] [retryCnt=0] [takeTime=781ns] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=416ns] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423]
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423] [takeTime=419ns] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`t`:0] [engineUUID=62a37f13-b9da-5fc9-86bc-65065f9b6423] [takeTime=557.189µs] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`t`] [takeTime=4.586441ms] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c]
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c] [takeTime=243ns] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=6.48759ms] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=454ns] []
[2023/03/26 22:51:04.108 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c]
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c] [retryCnt=0]
[2023/03/26 22:51:04.108 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c] [retryCnt=0] [takeTime=560ns] []
[2023/03/26 22:51:04.109 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:51:04.109 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=534ns] []
[2023/03/26 22:51:04.109 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=623.503µs] []
[2023/03/26 22:51:04.109 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=7.565906ms] []
[2023/03/26 22:51:04.109 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:51:04.109 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=264ns] []
[2023/03/26 22:51:04.109 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c]
[2023/03/26 22:51:04.109 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c] [takeTime=390ns] []
[2023/03/26 22:51:04.109 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`t`:-1] [engineUUID=9b602026-8df4-5acc-bb8c-4b386480993c] [takeTime=818.249µs] []
[2023/03/26 22:51:04.110 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:51:04.110 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/26 22:51:04.110 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=533ns] []
[2023/03/26 22:51:04.110 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:51:04.110 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=380ns] []
[2023/03/26 22:51:04.110 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=717.783µs] []
[2023/03/26 22:51:04.112 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`t`] [takeTime=11.595691ms] []
[2023/03/26 22:51:04.112 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=12.201333ms] []
[2023/03/26 22:51:21.389 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000010000.sql:0] [readDur=277.961321ms] [encodeDur=212.162206ms] [deliverDur=17.25036141s] [checksum="{cksum=0,size=17122257,kvs=300024}"] [takeTime=17.286406712s] []
[2023/03/26 22:51:21.390 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`emp`] [engineNumber=0] [read=0] [written=17122257] [takeTime=17.287021301s] []
[2023/03/26 22:51:21.391 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:51:21.391 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=480ns] []
[2023/03/26 22:51:21.391 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=17.28843818s] []
[2023/03/26 22:51:21.391 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:51:21.391 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0]
[2023/03/26 22:51:21.391 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0] [takeTime=711ns] []
[2023/03/26 22:51:21.392 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:51:21.392 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=352ns] []
[2023/03/26 22:51:21.392 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=433.359µs] []
[2023/03/26 22:51:21.392 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`emp`] [takeTime=17.289004559s] []
[2023/03/26 22:51:21.392 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:51:21.392 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=216ns] []
[2023/03/26 22:51:21.392 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:51:21.392 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0]
[2023/03/26 22:51:21.392 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0] [takeTime=490ns] []
[2023/03/26 22:51:21.393 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:51:21.393 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=330ns] []
[2023/03/26 22:51:21.393 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=597.667µs] []
[2023/03/26 22:51:21.394 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`emp`] [takeTime=17.293949776s] []
[2023/03/26 22:52:00.104 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`sal`] [engineNumber=0] [fileIndex=0] [path=emp.sal.0000000010000.sql:0] [readDur=757.350402ms] [encodeDur=650.548206ms] [deliverDur=55.893682345s] [checksum="{cksum=0,size=50386915,kvs=1280000}"] [takeTime=56.001601227s] []
[2023/03/26 22:52:00.105 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`sal`] [engineNumber=0] [read=0] [written=50386915] [takeTime=56.003836104s] []
[2023/03/26 22:52:00.106 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f]
[2023/03/26 22:52:00.106 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f] [takeTime=553ns] []
[2023/03/26 22:52:00.106 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`sal`] [engineNumber=0] [takeTime=56.004738557s] []
[2023/03/26 22:52:00.106 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f]
[2023/03/26 22:52:00.106 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f] [retryCnt=0]
[2023/03/26 22:52:00.106 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f] [retryCnt=0] [takeTime=640ns] []
[2023/03/26 22:52:00.106 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f]
[2023/03/26 22:52:00.106 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f] [takeTime=295ns] []
[2023/03/26 22:52:00.107 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`sal`:0] [engineUUID=9f1d37bc-9034-5f15-98ff-941d589da00f] [takeTime=327.321µs] []
[2023/03/26 22:52:00.107 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`sal`] [takeTime=56.005229797s] []
[2023/03/26 22:52:00.107 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29]
[2023/03/26 22:52:00.107 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29] [takeTime=209ns] []
[2023/03/26 22:52:00.107 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29]
[2023/03/26 22:52:00.107 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29] [retryCnt=0]
[2023/03/26 22:52:00.107 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29] [retryCnt=0] [takeTime=447ns] []
[2023/03/26 22:52:00.107 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29]
[2023/03/26 22:52:00.107 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29] [takeTime=345ns] []
[2023/03/26 22:52:00.107 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`sal`:-1] [engineUUID=9399ef59-7592-5f42-9594-5b81a69a0c29] [takeTime=486.333µs] []
[2023/03/26 22:52:00.108 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`sal`] [takeTime=56.008635882s] []
[2023/03/26 22:52:00.108 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/26 22:52:00.108 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=56.009656814s] []
[2023/03/26 22:52:00.109 +08:00] [INFO] [restore.go:1192] ["everything imported, stopping periodic actions"]
[2023/03/26 22:52:00.109 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/26 22:52:00.109 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1679842261361658000]
[2023/03/26 22:52:00.109 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1679842261361658000] [takeTime=402.092µs] []
[2023/03/26 22:52:00.109 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=58.733749358s] []
[2023/03/26 22:52:00.110 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]
[2023/03/26 22:56:37.545 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/26 22:56:37.546 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/26 22:56:37.547 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1679842597546763000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/26 22:56:37.548 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/26 22:56:37.553 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/26 22:56:37.553 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=334.088µs] []
[2023/03/26 22:56:37.560 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/26 22:56:37.560 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/26 22:56:37.561 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/26 22:56:37.562 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/26 22:56:38.020 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:56:38.933 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=1.371152969s] []
[2023/03/26 22:56:38.953 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:56:38.982 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/26 22:56:38.983 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/26 22:56:38.984 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/26 22:56:38.984 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/26 22:56:38.984 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/26 22:56:38.984 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/26 22:56:38.984 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=57.336µs]
[2023/03/26 22:56:38.984 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=92.908µs] []
[2023/03/26 22:56:38.984 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=69.748µs]
[2023/03/26 22:56:38.984 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=101.963µs] []
[2023/03/26 22:56:38.984 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:56:38.984 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/26 22:56:38.985 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:56:38.985 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/26 22:56:38.985 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/26 22:56:38.985 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/26 22:56:38.985 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:56:38.985 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:56:38.985 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/26 22:56:38.985 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/26 22:56:38.985 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/26 22:56:38.985 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:56:38.986 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000010000.sql:0]
[2023/03/26 22:56:38.986 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000010000.sql:0]
[2023/03/26 22:56:38.989 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000010000.sql:0] [readDur=279.898µs] [encodeDur=19.058µs] [deliverDur=2.237464ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=2.651184ms] []
[2023/03/26 22:56:38.989 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=3.517876ms] []
[2023/03/26 22:56:38.989 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:56:38.989 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=440ns] []
[2023/03/26 22:56:38.990 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=4.462459ms] []
[2023/03/26 22:56:38.990 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=544ns] []
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=361ns] []
[2023/03/26 22:56:38.990 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=360.409µs] []
[2023/03/26 22:56:38.990 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=4.931982ms] []
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=239ns] []
[2023/03/26 22:56:38.990 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/26 22:56:38.990 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=498ns] []
[2023/03/26 22:56:38.991 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/26 22:56:38.991 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=347ns] []
[2023/03/26 22:56:38.991 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=363.563µs] []
[2023/03/26 22:56:38.992 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=7.742431ms] []
[2023/03/26 22:56:39.084 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000010000.sql:0] [readDur=1.871706ms] [encodeDur=1.907387ms] [deliverDur=94.052882ms] [checksum="{cksum=0,size=112697,kvs=1998}"] [takeTime=98.393812ms] []
[2023/03/26 22:56:39.085 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`emp`] [engineNumber=0] [read=0] [written=112697] [takeTime=99.668137ms] []
[2023/03/26 22:56:39.085 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:56:39.085 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=721ns] []
[2023/03/26 22:56:39.086 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=101.194598ms] []
[2023/03/26 22:56:39.086 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:56:39.086 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0]
[2023/03/26 22:56:39.086 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0] [takeTime=781ns] []
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=310ns] []
[2023/03/26 22:56:39.087 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=590.344µs] []
[2023/03/26 22:56:39.087 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`emp`] [takeTime=101.956067ms] []
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=205ns] []
[2023/03/26 22:56:39.087 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0]
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0] [takeTime=434ns] []
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/26 22:56:39.087 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=319ns] []
[2023/03/26 22:56:39.087 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=368.611µs] []
[2023/03/26 22:56:39.088 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`emp`] [takeTime=104.367218ms] []
[2023/03/26 22:56:39.088 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/26 22:56:39.088 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=104.962084ms] []
[2023/03/26 22:56:39.088 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/26 22:56:39.089 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1679842597546763000]
[2023/03/26 22:56:39.089 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1679842597546763000] [takeTime=83.111µs] []
[2023/03/26 22:56:39.089 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=1.526808571s] []
[2023/03/26 22:56:39.089 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]
[2023/03/27 00:15:25.061 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/27 00:15:25.063 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/27 00:15:25.063 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1679847325063365000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/27 00:15:25.064 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/27 00:15:25.069 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/27 00:15:25.070 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=380.809µs] []
[2023/03/27 00:15:25.077 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/27 00:15:25.077 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/27 00:15:25.078 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/27 00:15:25.079 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/27 00:15:25.526 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:15:25.581 +08:00] [WARN] [util.go:192] ["run create schema job failed with no retry"] [query="CREATE TABLE IF NOT EXISTS `emp`.`emp` (`emp_no` INT(11) NOT NULL,`birth_date` DATE NOT NULL,`first_name` VARCHAR(14) NOT NULL,`last_name` VARCHAR(16) NOT NULL,`gender` ENUM('M','F') NOT NULL,`hire_date` DATE NOT NULL,`commission` DECIMAL(0,1) NULL,PRIMARY KEY(`emp_no`)) ENGINE = InnoDB DEFAULT CHARACTER SET = UTF8MB4 DEFAULT COLLATE = UTF8MB4_BIN;"] [args=null] [retryCnt=0] [error="Error 1427 (42000): For float(M,D), double(M,D) or decimal(M,D), M must be >= D (column 'commission')."]
[2023/03/27 00:15:25.608 +08:00] [ERROR] [restore.go:706] ["execute SQL: CREATE TABLE IF NOT EXISTS `emp`.`emp` (`emp_no` INT(11) NOT NULL,`birth_date` DATE NOT NULL,`first_name` VARCHAR(14) NOT NULL,`last_name` VARCHAR(16) NOT NULL,`gender` ENUM('M','F') NOT NULL,`hire_date` DATE NOT NULL,`commission` DECIMAL(0,1) NULL,PRIMARY KEY(`emp_no`)) ENGINE = InnoDB DEFAULT CHARACTER SET = UTF8MB4 DEFAULT COLLATE = UTF8MB4_BIN; failed"] [db=emp] [table=emp] [takeTime=53.509661ms] [error="run create schema job failed: Error 1427 (42000): For float(M,D), double(M,D) or decimal(M,D), M must be >= D (column 'commission')."]
[2023/03/27 00:15:25.618 +08:00] [ERROR] [restore.go:792] ["restore all schema failed"] [takeTime=538.855207ms] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `emp`.`emp`, stmt: restore table schema: run create schema job failed: Error 1427 (42000): For float(M,D), double(M,D) or decimal(M,D), M must be >= D (column 'commission')."]
[2023/03/27 00:15:25.618 +08:00] [WARN] [util.go:192] ["run create schema job failed with no retry"] [query="CREATE TABLE IF NOT EXISTS `emp`.`dep` (`dept_no` CHAR(4) NOT NULL,`dept_name` VARCHAR(40) NOT NULL,PRIMARY KEY(`dept_no`),UNIQUE `dept_name`(`dept_name`)) ENGINE = InnoDB DEFAULT CHARACTER SET = UTF8MB4 DEFAULT COLLATE = UTF8MB4_BIN;"] [args=null] [retryCnt=0] [error="context canceled"]
[2023/03/27 00:15:25.618 +08:00] [ERROR] [restore.go:486] ["run failed"] [step=1] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `emp`.`emp`, stmt: restore table schema: run create schema job failed: Error 1427 (42000): For float(M,D), double(M,D) or decimal(M,D), M must be >= D (column 'commission')."]
[2023/03/27 00:15:25.619 +08:00] [ERROR] [restore.go:496] ["the whole procedure failed"] [takeTime=539.435467ms] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `emp`.`emp`, stmt: restore table schema: run create schema job failed: Error 1427 (42000): For float(M,D), double(M,D) or decimal(M,D), M must be >= D (column 'commission')."]
[2023/03/27 00:15:25.619 +08:00] [ERROR] [main.go:103] ["tidb lightning encountered error stack info"] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `emp`.`emp`, stmt: restore table schema: run create schema job failed: Error 1427 (42000): For float(M,D), double(M,D) or decimal(M,D), M must be >= D (column 'commission')."]
[2023/03/27 00:16:18.034 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/27 00:16:18.034 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/27 00:16:18.034 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1679847378034676000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/27 00:16:18.035 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/27 00:16:18.038 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/27 00:16:18.039 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=346.686µs] []
[2023/03/27 00:16:18.044 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/27 00:16:18.045 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/27 00:16:18.045 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/27 00:16:18.045 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/27 00:16:18.047 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:16:18.719 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=674.076744ms] []
[2023/03/27 00:16:18.739 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:16:18.747 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/27 00:16:18.759 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/27 00:16:18.759 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/27 00:16:18.759 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/27 00:16:18.759 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/27 00:16:18.760 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/27 00:16:18.760 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=63.366µs]
[2023/03/27 00:16:18.760 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=89.514µs] []
[2023/03/27 00:16:18.760 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=84.563µs]
[2023/03/27 00:16:18.760 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=107.446µs] []
[2023/03/27 00:16:18.760 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:16:18.760 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:16:18.760 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:16:18.760 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/27 00:16:18.760 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:16:18.760 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:16:18.760 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:16:18.761 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:16:18.761 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/27 00:16:18.761 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:16:18.761 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:16:18.761 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:16:18.762 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000010000.sql:0]
[2023/03/27 00:16:18.762 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000010000.sql:0]
[2023/03/27 00:16:18.762 +08:00] [WARN] [table_restore.go:961] ["column missing from data file, going to fill with default value"] [table=`emp`.`emp`] [table=emp] [colName=commission] [colType=unspecified]
[2023/03/27 00:16:18.765 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000010000.sql:0] [readDur=250.902µs] [encodeDur=10.997µs] [deliverDur=2.583504ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=2.941406ms] []
[2023/03/27 00:16:18.765 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=3.971382ms] []
[2023/03/27 00:16:18.765 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:16:18.765 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=403ns] []
[2023/03/27 00:16:18.766 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=4.875786ms] []
[2023/03/27 00:16:18.766 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=562ns] []
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=391ns] []
[2023/03/27 00:16:18.766 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=347.837µs] []
[2023/03/27 00:16:18.766 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=5.321636ms] []
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=214ns] []
[2023/03/27 00:16:18.766 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/27 00:16:18.766 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=527ns] []
[2023/03/27 00:16:18.767 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:16:18.767 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=368ns] []
[2023/03/27 00:16:18.767 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=333.436µs] []
[2023/03/27 00:16:18.768 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=8.001904ms] []
[2023/03/27 00:16:18.930 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000010000.sql:0] [readDur=1.930896ms] [encodeDur=1.563441ms] [deliverDur=164.497428ms] [checksum="{cksum=0,size=112697,kvs=1998}"] [takeTime=168.455586ms] []
[2023/03/27 00:16:18.930 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`emp`] [engineNumber=0] [read=0] [written=112697] [takeTime=169.752742ms] []
[2023/03/27 00:16:18.931 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:16:18.931 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=715ns] []
[2023/03/27 00:16:18.931 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=170.756193ms] []
[2023/03/27 00:16:18.931 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:16:18.931 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0]
[2023/03/27 00:16:18.931 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0] [takeTime=705ns] []
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=370ns] []
[2023/03/27 00:16:18.932 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=357.443µs] []
[2023/03/27 00:16:18.932 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`emp`] [takeTime=171.24283ms] []
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=210ns] []
[2023/03/27 00:16:18.932 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0]
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0] [takeTime=540ns] []
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:16:18.932 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=378ns] []
[2023/03/27 00:16:18.932 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=350.763µs] []
[2023/03/27 00:16:18.933 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`emp`] [takeTime=173.676071ms] []
[2023/03/27 00:16:18.933 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/27 00:16:18.933 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=174.598895ms] []
[2023/03/27 00:16:18.933 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/27 00:16:18.933 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1679847378034676000]
[2023/03/27 00:16:18.933 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1679847378034676000] [takeTime=76.354µs] []
[2023/03/27 00:16:18.933 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=888.679432ms] []
[2023/03/27 00:16:18.933 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]
[2023/03/27 00:24:46.825 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/27 00:24:46.831 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/27 00:24:46.832 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1679847886831728000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/27 00:24:46.832 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/27 00:24:46.838 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/27 00:24:46.839 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=350.544µs] []
[2023/03/27 00:24:46.877 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/27 00:24:46.878 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/27 00:24:46.879 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/27 00:24:46.880 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/27 00:24:47.407 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:24:48.485 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=1.605333437s] []
[2023/03/27 00:24:48.505 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:24:48.533 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/27 00:24:48.561 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/27 00:24:48.562 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/27 00:24:48.562 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/27 00:24:48.580 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/27 00:24:48.615 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/27 00:24:48.634 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=94.454µs]
[2023/03/27 00:24:48.634 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=190.337µs] []
[2023/03/27 00:24:48.634 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=171.552µs]
[2023/03/27 00:24:48.669 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:24:48.706 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=71.666529ms] []
[2023/03/27 00:24:48.706 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:24:48.724 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:24:48.724 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/27 00:24:48.724 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:24:48.724 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:24:48.724 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:24:48.724 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:24:48.724 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/27 00:24:48.724 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:24:48.724 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:24:48.724 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:24:48.725 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0]
[2023/03/27 00:24:48.725 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0]
[2023/03/27 00:24:48.726 +08:00] [ERROR] [tidb.go:471] ["column count mismatch"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0] [column_permutation="[0,1,2,3,4,5,6]"] [data="[\"{kind=uint64,val=10001}\",\"{kind=string,val=1953-09-02}\",\"{kind=string,val=Georgi}\",\"{kind=string,val=Facello}\",\"{kind=string,val=M}\",\"{kind=string,val=1986-06-26}\"]"]
[2023/03/27 00:24:48.726 +08:00] [ERROR] [tidb.go:471] ["column count mismatch"] [column_permutation="[0,1,2,3,4,5,6]"] [data="[\"{kind=uint64,val=10001}\",\"{kind=string,val=1953-09-02}\",\"{kind=string,val=Georgi}\",\"{kind=string,val=Facello}\",\"{kind=string,val=M}\",\"{kind=string,val=1986-06-26}\"]"]
[2023/03/27 00:24:48.726 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0] [readDur=0s] [encodeDur=0s] [deliverDur=702ns] [checksum="{cksum=0,size=0,kvs=0}"] [takeTime=896.684µs] []
[2023/03/27 00:24:48.726 +08:00] [ERROR] [table_restore.go:628] ["encode kv data and write failed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=2.418033ms] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.726 +08:00] [ERROR] [table_restore.go:326] ["restore engine failed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=2.506425ms] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.726 +08:00] [ERROR] [table_restore.go:352] ["import whole table failed"] [table=`emp`.`emp`] [takeTime=2.614805ms] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.726 +08:00] [ERROR] [restore.go:1584] ["restore table failed"] [table=`emp`.`emp`] [takeTime=145.905696ms] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.729 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0] [readDur=373.625µs] [encodeDur=13.491µs] [deliverDur=3.037666ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=3.523417ms] []
[2023/03/27 00:24:48.729 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=4.695492ms] []
[2023/03/27 00:24:48.729 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:24:48.730 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=503ns] []
[2023/03/27 00:24:48.730 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=5.769061ms] []
[2023/03/27 00:24:48.730 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:24:48.730 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/27 00:24:48.730 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=840ns] []
[2023/03/27 00:24:48.730 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:24:48.730 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=416ns] []
[2023/03/27 00:24:48.730 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=411.68µs] []
[2023/03/27 00:24:48.730 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=6.307139ms] []
[2023/03/27 00:24:48.730 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:24:48.730 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=305ns] []
[2023/03/27 00:24:48.731 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:24:48.731 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/27 00:24:48.731 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=515ns] []
[2023/03/27 00:24:48.731 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:24:48.731 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=350ns] []
[2023/03/27 00:24:48.731 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=336.875µs] []
[2023/03/27 00:24:48.732 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=116.612082ms] []
[2023/03/27 00:24:48.732 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/27 00:24:48.732 +08:00] [ERROR] [restore.go:1549] ["restore all tables data failed"] [takeTime=170.524546ms] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.732 +08:00] [ERROR] [restore.go:486] ["run failed"] [step=4] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.732 +08:00] [ERROR] [restore.go:496] ["the whole procedure failed"] [takeTime=1.852348729s] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.732 +08:00] [ERROR] [restore.go:172] ["tables failed to be imported"] [count=1]
[2023/03/27 00:24:48.732 +08:00] [ERROR] [restore.go:174] [-] [table=`emp`.`emp`] [status=written] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:24:48.732 +08:00] [ERROR] [main.go:103] ["tidb lightning encountered error stack info"] [error="[Lightning:Restore:ErrEncodeKV]encode kv error in file emp.emp.0000000000000.sql:0 at offset 110: column count mismatch, expected 7, got 6"]
[2023/03/27 00:26:15.515 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/27 00:26:15.516 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/27 00:26:15.516 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1679847975516423000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/27 00:26:15.517 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/27 00:26:15.523 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/27 00:26:15.524 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=424.269µs] []
[2023/03/27 00:26:15.531 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/27 00:26:15.531 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/27 00:26:15.532 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/27 00:26:15.533 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/27 00:26:15.544 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:15.547 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=13.401492ms] []
[2023/03/27 00:26:15.548 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:15.558 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/27 00:26:15.559 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/27 00:26:15.559 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/27 00:26:15.559 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/27 00:26:15.559 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/27 00:26:15.559 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/27 00:26:15.559 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=89.223µs]
[2023/03/27 00:26:15.559 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=133.579µs] []
[2023/03/27 00:26:15.559 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=143.035µs]
[2023/03/27 00:26:15.559 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=199.824µs] []
[2023/03/27 00:26:15.560 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:15.560 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:15.560 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:15.560 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/27 00:26:15.560 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:26:15.560 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:26:15.560 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:26:15.560 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/27 00:26:15.560 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:15.561 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:26:15.561 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:26:15.561 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:26:15.561 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0]
[2023/03/27 00:26:15.561 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0]
[2023/03/27 00:26:15.562 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0] [readDur=0s] [encodeDur=0s] [deliverDur=576ns] [checksum="{cksum=0,size=0,kvs=0}"] [takeTime=436.228µs] []
[2023/03/27 00:26:15.562 +08:00] [ERROR] [table_restore.go:628] ["encode kv data and write failed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=1.144398ms] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.562 +08:00] [ERROR] [table_restore.go:326] ["restore engine failed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=1.8673ms] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.562 +08:00] [ERROR] [table_restore.go:352] ["import whole table failed"] [table=`emp`.`emp`] [takeTime=1.957506ms] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.562 +08:00] [ERROR] [restore.go:1584] ["restore table failed"] [table=`emp`.`emp`] [takeTime=3.235831ms] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.563 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0] [readDur=222.257µs] [encodeDur=11.59µs] [deliverDur=1.192548ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=1.519549ms] []
[2023/03/27 00:26:15.563 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=2.368317ms] []
[2023/03/27 00:26:15.563 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:15.563 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=513ns] []
[2023/03/27 00:26:15.564 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=3.357979ms] []
[2023/03/27 00:26:15.564 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:15.564 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/27 00:26:15.564 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=545ns] []
[2023/03/27 00:26:15.564 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:15.564 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=307ns] []
[2023/03/27 00:26:15.564 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=366.56µs] []
[2023/03/27 00:26:15.564 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=3.822286ms] []
[2023/03/27 00:26:15.564 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:15.564 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=202ns] []
[2023/03/27 00:26:15.565 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:15.565 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/27 00:26:15.565 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=420ns] []
[2023/03/27 00:26:15.565 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:15.565 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=359ns] []
[2023/03/27 00:26:15.565 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=392.638µs] []
[2023/03/27 00:26:15.566 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=6.802682ms] []
[2023/03/27 00:26:15.566 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/27 00:26:15.566 +08:00] [ERROR] [restore.go:1549] ["restore all tables data failed"] [takeTime=7.442681ms] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.566 +08:00] [ERROR] [restore.go:486] ["run failed"] [step=4] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.566 +08:00] [ERROR] [restore.go:496] ["the whole procedure failed"] [takeTime=33.170625ms] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.566 +08:00] [ERROR] [restore.go:172] ["tables failed to be imported"] [count=1]
[2023/03/27 00:26:15.566 +08:00] [ERROR] [restore.go:174] [-] [table=`emp`.`emp`] [status=written] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"]
[2023/03/27 00:26:15.566 +08:00] [ERROR] [main.go:103] ["tidb lightning encountered error stack info"] [error="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp"] [errorVerbose="[Lightning:Restore:ErrUnknownColumns]unknown columns in header (empno) for table emp\ngithub.com/pingcap/errors.AddStack\n\t/Users/pingcap/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/errors.go:174\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/Users/pingcap/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/normalize.go:164\ngithub.com/pingcap/tidb/br/pkg/lightning/restore.parseColumnPermutations\n\t/Users/pingcap/workspace/build-common@2/go/src/github.com/pingcap/br/br/pkg/lightning/restore/table_restore.go:944\ngithub.com/pingcap/tidb/br/pkg/lightning/restore.createColumnPermutation\n\t/Users/pingcap/workspace/build-common@2/go/src/github.com/pingcap/br/br/pkg/lightning/restore/table_restore.go:207\ngithub.com/pingcap/tidb/br/pkg/lightning/restore.(*TableRestore).initializeColumns\n\t/Users/pingcap/workspace/build-common@2/go/src/github.com/pingcap/br/br/pkg/lightning/restore/table_restore.go:173\ngithub.com/pingcap/tidb/br/pkg/lightning/restore.(*chunkRestore).encodeLoop\n\t/Users/pingcap/workspace/build-common@2/go/src/github.com/pingcap/br/br/pkg/lightning/restore/restore.go:2671\ngithub.com/pingcap/tidb/br/pkg/lightning/restore.(*chunkRestore).restore\n\t/Users/pingcap/workspace/build-common@2/go/src/github.com/pingcap/br/br/pkg/lightning/restore/restore.go:2802\ngithub.com/pingcap/tidb/br/pkg/lightning/restore.(*TableRestore).restoreEngine.func3\n\t/Users/pingcap/workspace/build-common@2/go/src/github.com/pingcap/br/br/pkg/lightning/restore/table_restore.go:582\nruntime.goexit\n\t/usr/local/go1.19.5/src/runtime/asm_amd64.s:1594"]
[2023/03/27 00:26:30.546 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/27 00:26:30.546 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/27 00:26:30.547 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1679847990546965000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/27 00:26:30.548 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/27 00:26:30.551 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/27 00:26:30.552 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=393.178µs] []
[2023/03/27 00:26:30.558 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/27 00:26:30.558 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/27 00:26:30.558 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/27 00:26:30.558 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/27 00:26:30.561 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:30.563 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=4.478446ms] []
[2023/03/27 00:26:30.563 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:30.571 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/27 00:26:30.572 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/27 00:26:30.572 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/27 00:26:30.572 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/27 00:26:30.572 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/27 00:26:30.572 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/27 00:26:30.572 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=89.1µs]
[2023/03/27 00:26:30.572 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=139.243µs] []
[2023/03/27 00:26:30.572 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=66.362µs]
[2023/03/27 00:26:30.572 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=128.729µs] []
[2023/03/27 00:26:30.573 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:30.573 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=6.6.0]
[2023/03/27 00:26:30.573 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:30.573 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/27 00:26:30.573 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:26:30.573 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/27 00:26:30.573 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:30.573 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0]
[2023/03/27 00:26:30.574 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:26:30.574 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/27 00:26:30.574 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:26:30.574 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/27 00:26:30.574 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:26:30.574 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0]
[2023/03/27 00:26:30.575 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0] [readDur=267.79µs] [encodeDur=10.498µs] [deliverDur=1.021165ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=1.422348ms] []
[2023/03/27 00:26:30.575 +08:00] [WARN] [table_restore.go:961] ["column missing from data file, going to fill with default value"] [table=`emp`.`emp`] [table=emp] [colName=commission] [colType=unspecified]
[2023/03/27 00:26:30.575 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=1.665808ms] []
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=457ns] []
[2023/03/27 00:26:30.576 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=2.628077ms] []
[2023/03/27 00:26:30.576 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=571ns] []
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=417ns] []
[2023/03/27 00:26:30.576 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=372.29µs] []
[2023/03/27 00:26:30.576 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=3.104676ms] []
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:30.576 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=250ns] []
[2023/03/27 00:26:30.577 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:30.577 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/27 00:26:30.577 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=496ns] []
[2023/03/27 00:26:30.577 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/27 00:26:30.577 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=368ns] []
[2023/03/27 00:26:30.577 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=365.721µs] []
[2023/03/27 00:26:30.578 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=5.715546ms] []
[2023/03/27 00:26:32.021 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0] [readDur=26.430089ms] [encodeDur=21.51991ms] [deliverDur=1.440440559s] [checksum="{cksum=0,size=1691332,kvs=29997}"] [takeTime=1.446999585s] []
[2023/03/27 00:26:32.022 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`emp`] [engineNumber=0] [read=0] [written=1691332] [takeTime=1.447921282s] []
[2023/03/27 00:26:32.022 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:26:32.023 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=983ns] []
[2023/03/27 00:26:32.023 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=1.449276187s] []
[2023/03/27 00:26:32.023 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:26:32.023 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0]
[2023/03/27 00:26:32.023 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0] [takeTime=752ns] []
[2023/03/27 00:26:32.023 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/27 00:26:32.023 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=382ns] []
[2023/03/27 00:26:32.023 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=476.344µs] []
[2023/03/27 00:26:32.023 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`emp`] [takeTime=1.449839223s] []
[2023/03/27 00:26:32.023 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:26:32.023 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=210ns] []
[2023/03/27 00:26:32.024 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:26:32.024 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0]
[2023/03/27 00:26:32.024 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0] [takeTime=398ns] []
[2023/03/27 00:26:32.024 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/27 00:26:32.024 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=323ns] []
[2023/03/27 00:26:32.024 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=493.349µs] []
[2023/03/27 00:26:32.025 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`emp`] [takeTime=1.453282889s] []
[2023/03/27 00:26:32.025 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/27 00:26:32.026 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=1.453464481s] []
[2023/03/27 00:26:32.026 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/27 00:26:32.026 +08:00] [INFO] [restore.go:1192] ["everything imported, stopping periodic actions"]
[2023/03/27 00:26:32.026 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1679847990546965000]
[2023/03/27 00:26:32.026 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1679847990546965000] [takeTime=461.51µs] []
[2023/03/27 00:26:32.026 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=1.467660586s] []
[2023/03/27 00:26:32.026 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]
[2023/03/30 09:59:53.013 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/30 09:59:53.014 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/30 09:59:53.015 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1680141593014982000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/mydb-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/30 09:59:53.015 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/30 09:59:53.021 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/30 09:59:53.022 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=645.425µs] []
[2023/03/30 09:59:53.029 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/30 09:59:53.029 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/30 09:59:53.030 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/30 09:59:53.032 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/30 09:59:53.555 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 09:59:53.983 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=951.422491ms] []
[2023/03/30 09:59:54.002 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 09:59:54.029 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/30 09:59:54.030 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/30 09:59:54.032 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`mydb`.`payments`]
[2023/03/30 09:59:54.032 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`mydb`.`payments`]
[2023/03/30 09:59:54.032 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=107.478µs]
[2023/03/30 09:59:54.032 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`mydb`.`payments`] [enginesCnt=2] [filesCnt=1] [takeTime=145.96µs] []
[2023/03/30 09:59:54.032 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 09:59:54.032 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 09:59:54.032 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`mydb`.`payments`]
[2023/03/30 09:59:54.033 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`mydb`.`payments`] [engineNumber=0]
[2023/03/30 09:59:54.033 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`mydb`.`payments`] [engineNumber=0]
[2023/03/30 09:59:54.033 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 09:59:54.034 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`mydb`.`payments`] [engineNumber=0] [fileIndex=0] [path=mydb.payments.000000000.sql:0]
[2023/03/30 09:59:54.035 +08:00] [WARN] [table_restore.go:961] ["column missing from data file, going to fill with default value"] [table=`mydb`.`payments`] [table=payments] [colName=amount] [colType=unspecified]
[2023/03/30 09:59:54.589 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`mydb`.`payments`] [engineNumber=0] [fileIndex=0] [path=mydb.payments.000000000.sql:0] [readDur=7.068937ms] [encodeDur=7.193376ms] [deliverDur=545.369662ms] [checksum="{cksum=0,size=320151,kvs=20078}"] [takeTime=555.260574ms] []
[2023/03/30 09:59:54.589 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`mydb`.`payments`] [engineNumber=0] [read=0] [written=320151] [takeTime=556.364071ms] []
[2023/03/30 09:59:54.590 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 09:59:54.590 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [takeTime=562ns] []
[2023/03/30 09:59:54.591 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`mydb`.`payments`] [engineNumber=0] [takeTime=557.93504ms] []
[2023/03/30 09:59:54.591 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 09:59:54.591 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [retryCnt=0]
[2023/03/30 09:59:54.591 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [retryCnt=0] [takeTime=800ns] []
[2023/03/30 09:59:54.591 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 09:59:54.591 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [takeTime=355ns] []
[2023/03/30 09:59:54.591 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [takeTime=599.101µs] []
[2023/03/30 09:59:54.591 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`mydb`.`payments`] [takeTime=558.97931ms] []
[2023/03/30 09:59:54.592 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 09:59:54.592 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [takeTime=212ns] []
[2023/03/30 09:59:54.592 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 09:59:54.592 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [retryCnt=0]
[2023/03/30 09:59:54.592 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [retryCnt=0] [takeTime=534ns] []
[2023/03/30 09:59:54.592 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 09:59:54.592 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [takeTime=385ns] []
[2023/03/30 09:59:54.592 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [takeTime=352.441µs] []
[2023/03/30 09:59:54.593 +08:00] [INFO] [tidb.go:354] ["alter table auto_increment start"] [table=`mydb`.`payments`] [auto_increment=1]
[2023/03/30 09:59:55.184 +08:00] [INFO] [tidb.go:356] ["alter table auto_increment completed"] [table=`mydb`.`payments`] [auto_increment=1] [takeTime=591.281811ms] []
[2023/03/30 09:59:55.203 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`mydb`.`payments`] [takeTime=1.171841445s] []
[2023/03/30 09:59:55.204 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/30 09:59:55.204 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=1.173431821s] []
[2023/03/30 09:59:55.204 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/30 09:59:55.204 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1680141593014982000]
[2023/03/30 09:59:55.204 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1680141593014982000] [takeTime=140.444µs] []
[2023/03/30 09:59:55.204 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=2.172671677s] []
[2023/03/30 09:59:55.204 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]
[2023/03/30 10:00:03.331 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/30 10:00:03.331 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/30 10:00:03.331 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1680141603331319000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/30 10:00:03.331 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/30 10:00:03.336 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/30 10:00:03.336 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=293.78µs] []
[2023/03/30 10:00:03.342 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/30 10:00:03.342 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/30 10:00:03.342 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/30 10:00:03.342 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/30 10:00:03.730 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 10:00:04.667 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=1.324778977s] []
[2023/03/30 10:00:04.688 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 10:00:04.714 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/30 10:00:04.782 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/30 10:00:04.800 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/30 10:00:04.800 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/30 10:00:04.800 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/30 10:00:04.800 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/30 10:00:04.800 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=103.824µs]
[2023/03/30 10:00:04.800 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=145.344µs] []
[2023/03/30 10:00:04.800 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=111.298µs]
[2023/03/30 10:00:04.800 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=211.869µs] []
[2023/03/30 10:00:04.801 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 10:00:04.801 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 10:00:04.801 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 10:00:04.801 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/30 10:00:04.801 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/30 10:00:04.801 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/30 10:00:04.801 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 10:00:04.802 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0]
[2023/03/30 10:00:04.802 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 10:00:04.802 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/30 10:00:04.802 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/30 10:00:04.802 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/30 10:00:04.802 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 10:00:04.802 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0]
[2023/03/30 10:00:04.803 +08:00] [WARN] [table_restore.go:961] ["column missing from data file, going to fill with default value"] [table=`emp`.`emp`] [table=emp] [colName=commission] [colType=unspecified]
[2023/03/30 10:00:04.804 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0] [readDur=165.214µs] [encodeDur=12.828µs] [deliverDur=2.242243ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=2.524987ms] []
[2023/03/30 10:00:04.804 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=2.729125ms] []
[2023/03/30 10:00:04.805 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 10:00:04.805 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=443ns] []
[2023/03/30 10:00:04.805 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=3.663391ms] []
[2023/03/30 10:00:04.805 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 10:00:04.805 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/30 10:00:04.805 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=730ns] []
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=435ns] []
[2023/03/30 10:00:04.806 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=367.604µs] []
[2023/03/30 10:00:04.806 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=4.133133ms] []
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=230ns] []
[2023/03/30 10:00:04.806 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=475ns] []
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 10:00:04.806 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=344ns] []
[2023/03/30 10:00:04.807 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=345.324µs] []
[2023/03/30 10:00:04.807 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=7.297775ms] []
[2023/03/30 10:00:06.173 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0] [readDur=24.609117ms] [encodeDur=18.664878ms] [deliverDur=1.3636317s] [checksum="{cksum=0,size=1691332,kvs=29997}"] [takeTime=1.371661875s] []
[2023/03/30 10:00:06.173 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`emp`] [engineNumber=0] [read=0] [written=1691332] [takeTime=1.371965309s] []
[2023/03/30 10:00:06.174 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 10:00:06.174 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=794ns] []
[2023/03/30 10:00:06.175 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=1.373149822s] []
[2023/03/30 10:00:06.175 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0]
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0] [takeTime=898ns] []
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=2.921µs] []
[2023/03/30 10:00:06.175 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=382.885µs] []
[2023/03/30 10:00:06.175 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`emp`] [takeTime=1.373661419s] []
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=240ns] []
[2023/03/30 10:00:06.175 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0]
[2023/03/30 10:00:06.175 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0] [takeTime=531ns] []
[2023/03/30 10:00:06.176 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 10:00:06.176 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=378ns] []
[2023/03/30 10:00:06.176 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=380.951µs] []
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`emp`] [takeTime=1.376546885s] []
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=1.37682576s] []
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:1192] ["everything imported, stopping periodic actions"]
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1680141603331319000]
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1680141603331319000] [takeTime=96.73µs] []
[2023/03/30 10:00:06.177 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=2.834470048s] []
[2023/03/30 10:00:06.177 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]
[2023/03/30 17:11:11.613 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/30 17:11:11.615 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/30 17:11:11.615 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1680167471615247000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/mydb-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/30 17:11:11.616 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/30 17:11:11.624 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/30 17:11:11.625 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=534.652µs] []
[2023/03/30 17:11:11.632 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/30 17:11:11.632 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/30 17:11:11.633 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/30 17:11:11.635 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/30 17:11:12.014 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 17:11:12.323 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=688.116799ms] []
[2023/03/30 17:11:12.358 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 17:11:12.390 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/30 17:11:12.471 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/30 17:11:12.472 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`mydb`.`payments`]
[2023/03/30 17:11:12.472 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`mydb`.`payments`]
[2023/03/30 17:11:12.472 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=76.427µs]
[2023/03/30 17:11:12.472 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`mydb`.`payments`] [enginesCnt=2] [filesCnt=1] [takeTime=107.939µs] []
[2023/03/30 17:11:12.473 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 17:11:12.473 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 17:11:12.473 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`mydb`.`payments`]
[2023/03/30 17:11:12.474 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`mydb`.`payments`] [engineNumber=0]
[2023/03/30 17:11:12.474 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`mydb`.`payments`] [engineNumber=0]
[2023/03/30 17:11:12.474 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 17:11:12.475 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`mydb`.`payments`] [engineNumber=0] [fileIndex=0] [path=mydb.payments.000000000.sql:0]
[2023/03/30 17:11:12.477 +08:00] [WARN] [table_restore.go:961] ["column missing from data file, going to fill with default value"] [table=`mydb`.`payments`] [table=payments] [colName=amount] [colType=unspecified]
[2023/03/30 17:11:13.011 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`mydb`.`payments`] [engineNumber=0] [fileIndex=0] [path=mydb.payments.000000000.sql:0] [readDur=7.464057ms] [encodeDur=7.266274ms] [deliverDur=525.812312ms] [checksum="{cksum=0,size=320151,kvs=20078}"] [takeTime=536.09967ms] []
[2023/03/30 17:11:13.012 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`mydb`.`payments`] [engineNumber=0] [read=0] [written=320151] [takeTime=537.718383ms] []
[2023/03/30 17:11:13.012 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 17:11:13.012 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [takeTime=1.002µs] []
[2023/03/30 17:11:13.013 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`mydb`.`payments`] [engineNumber=0] [takeTime=538.937854ms] []
[2023/03/30 17:11:13.013 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 17:11:13.013 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [retryCnt=0]
[2023/03/30 17:11:13.013 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [retryCnt=0] [takeTime=869ns] []
[2023/03/30 17:11:13.013 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103]
[2023/03/30 17:11:13.014 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [takeTime=570ns] []
[2023/03/30 17:11:13.014 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`mydb`.`payments`:0] [engineUUID=79ab9b3c-e1f8-543f-afc1-e024150aa103] [takeTime=810.098µs] []
[2023/03/30 17:11:13.014 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`mydb`.`payments`] [takeTime=540.291735ms] []
[2023/03/30 17:11:13.014 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 17:11:13.014 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [takeTime=451ns] []
[2023/03/30 17:11:13.014 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 17:11:13.014 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [retryCnt=0]
[2023/03/30 17:11:13.014 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [retryCnt=0] [takeTime=617ns] []
[2023/03/30 17:11:13.015 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e]
[2023/03/30 17:11:13.015 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [takeTime=411ns] []
[2023/03/30 17:11:13.015 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`mydb`.`payments`:-1] [engineUUID=78870b8a-b6e6-5d30-9f1b-dd6cf7d3d89e] [takeTime=487.468µs] []
[2023/03/30 17:11:13.015 +08:00] [INFO] [tidb.go:354] ["alter table auto_increment start"] [table=`mydb`.`payments`] [auto_increment=1]
[2023/03/30 17:11:13.480 +08:00] [INFO] [tidb.go:356] ["alter table auto_increment completed"] [table=`mydb`.`payments`] [auto_increment=1] [takeTime=464.515294ms] []
[2023/03/30 17:11:13.481 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`mydb`.`payments`] [takeTime=1.008455308s] []
[2023/03/30 17:11:13.481 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/30 17:11:13.481 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=1.010086882s] []
[2023/03/30 17:11:13.481 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/30 17:11:13.481 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1680167471615247000]
[2023/03/30 17:11:13.481 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1680167471615247000] [takeTime=107.685µs] []
[2023/03/30 17:11:13.481 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=1.846922174s] []
[2023/03/30 17:11:13.481 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]
[2023/03/30 17:11:26.467 +08:00] [WARN] [config.go:919] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2023/03/30 17:11:26.468 +08:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0] [git-hash=f4ca0821fb96a2bdd37d2fb97eb26c07fc58d4e4] [git-branch=heads/refs/tags/v6.6.0] [go-version=go1.19.5] [utc-build-time="2023-02-17 14:40:53"] [race-enabled=false]
[2023/03/30 17:11:26.468 +08:00] [INFO] [lightning.go:449] [cfg] [cfg="{\"id\":1680167486468049000,\"lightning\":{\"table-concurrency\":16,\"index-concurrency\":16,\"region-concurrency\":16,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":9223372036854775807},\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"imp\",\"status-port\":10080,\"pd-addr\":\"127.0.0.1:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"false\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///Users/guanglei/git/github/tidb-course-201-lab/scripts/misc/emp-sql-dump\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":\"\\\\N\",\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"tidb\",\"on-duplicate\":\"replace\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"sorted-kv-dir\":\"/tmp/sorted-kv-dir\",\"disk-quota\":9223372036854775807,\"range-concurrency\":0,\"duplicate-resolution\":\"none\",\"incremental-import\":true,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0},\"post-restore\":{\"checksum\":\"off\",\"analyze\":\"off\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":null,\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"black-white-list\":{\"do-tables\":null,\"do-dbs\":null,\"ignore-tables\":null,\"ignore-dbs\":null}}"]
[2023/03/30 17:11:26.468 +08:00] [INFO] [env.go:16] ["using proxy config"] [http_proxy=http://127.0.0.1:1087] [https_proxy=http://127.0.0.1:1087]
[2023/03/30 17:11:26.472 +08:00] [INFO] [lightning.go:554] ["load data source start"]
[2023/03/30 17:11:26.472 +08:00] [INFO] [lightning.go:557] ["load data source completed"] [takeTime=411.049µs] []
[2023/03/30 17:11:26.478 +08:00] [INFO] [lightning.go:581] ["acquired keyspace name"] [keyspaceName=]
[2023/03/30 17:11:26.478 +08:00] [INFO] [checkpoints.go:1037] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2023/03/30 17:11:26.478 +08:00] [INFO] [restore.go:468] ["the whole procedure start"]
[2023/03/30 17:11:26.478 +08:00] [INFO] [restore.go:776] ["restore all schema start"]
[2023/03/30 17:11:26.892 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 17:11:28.029 +08:00] [INFO] [restore.go:792] ["restore all schema completed"] [takeTime=1.550499763s] []
[2023/03/30 17:11:28.030 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 17:11:28.059 +08:00] [INFO] [tidb.go:239] ["skipping check requirements for tidb backend"]
[2023/03/30 17:11:28.066 +08:00] [INFO] [restore.go:1445] ["restore all tables data start"]
[2023/03/30 17:11:28.066 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`dep`]
[2023/03/30 17:11:28.066 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`dep`]
[2023/03/30 17:11:28.066 +08:00] [INFO] [restore.go:1578] ["restore table start"] [table=`emp`.`emp`]
[2023/03/30 17:11:28.066 +08:00] [INFO] [table_restore.go:98] ["load engines and files start"] [table=`emp`.`emp`]
[2023/03/30 17:11:28.066 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=64.851µs]
[2023/03/30 17:11:28.066 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`dep`] [enginesCnt=2] [filesCnt=1] [takeTime=98.422µs] []
[2023/03/30 17:11:28.066 +08:00] [INFO] [region.go:255] [makeTableRegions] [filesCount=1] [MaxRegionSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=109.109µs]
[2023/03/30 17:11:28.066 +08:00] [INFO] [table_restore.go:140] ["load engines and files completed"] [table=`emp`.`emp`] [enginesCnt=2] [filesCnt=1] [takeTime=148.713µs] []
[2023/03/30 17:11:28.067 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 17:11:28.067 +08:00] [INFO] [version.go:429] ["detect server version"] [type=TiDB] [version=7.1.0-alpha]
[2023/03/30 17:11:28.067 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 17:11:28.067 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`emp`]
[2023/03/30 17:11:28.067 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/30 17:11:28.067 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`emp`] [engineNumber=0]
[2023/03/30 17:11:28.067 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 17:11:28.068 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0]
[2023/03/30 17:11:28.068 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 17:11:28.068 +08:00] [INFO] [table_restore.go:277] ["import whole table start"] [table=`emp`.`dep`]
[2023/03/30 17:11:28.068 +08:00] [INFO] [table_restore.go:324] ["restore engine start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/30 17:11:28.068 +08:00] [INFO] [table_restore.go:453] ["encode kv data and write start"] [table=`emp`.`dep`] [engineNumber=0]
[2023/03/30 17:11:28.068 +08:00] [INFO] [backend.go:360] ["open engine"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 17:11:28.068 +08:00] [INFO] [restore.go:2800] ["restore file start"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0]
[2023/03/30 17:11:28.069 +08:00] [WARN] [table_restore.go:961] ["column missing from data file, going to fill with default value"] [table=`emp`.`emp`] [table=emp] [colName=commission] [colType=unspecified]
[2023/03/30 17:11:28.071 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`dep`] [engineNumber=0] [fileIndex=0] [path=emp.dep.0000000000000.sql:0] [readDur=213.748µs] [encodeDur=10.747µs] [deliverDur=2.373571ms] [checksum="{cksum=0,size=198,kvs=9}"] [takeTime=2.67537ms] []
[2023/03/30 17:11:28.071 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`dep`] [engineNumber=0] [read=0] [written=198] [takeTime=2.873098ms] []
[2023/03/30 17:11:28.071 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 17:11:28.071 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=390ns] []
[2023/03/30 17:11:28.072 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`dep`] [engineNumber=0] [takeTime=3.84232ms] []
[2023/03/30 17:11:28.072 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0]
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [retryCnt=0] [takeTime=644ns] []
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1]
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=359ns] []
[2023/03/30 17:11:28.072 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:0] [engineUUID=94fc38fb-ac71-5aac-af15-d7f6caf9ada1] [takeTime=351.707µs] []
[2023/03/30 17:11:28.072 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`dep`] [takeTime=4.304506ms] []
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=264ns] []
[2023/03/30 17:11:28.072 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0]
[2023/03/30 17:11:28.072 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [retryCnt=0] [takeTime=533ns] []
[2023/03/30 17:11:28.073 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0]
[2023/03/30 17:11:28.073 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=353ns] []
[2023/03/30 17:11:28.073 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`dep`:-1] [engineUUID=7b2017d6-1385-5bec-8935-d69def2f7ce0] [takeTime=352.504µs] []
[2023/03/30 17:11:28.074 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`dep`] [takeTime=7.240254ms] []
[2023/03/30 17:11:29.527 +08:00] [INFO] [restore.go:2807] ["restore file completed"] [table=`emp`.`emp`] [engineNumber=0] [fileIndex=0] [path=emp.emp.0000000000000.sql:0] [readDur=26.555172ms] [encodeDur=19.246692ms] [deliverDur=1.45207212s] [checksum="{cksum=0,size=1691332,kvs=29997}"] [takeTime=1.459606538s] []
[2023/03/30 17:11:29.527 +08:00] [INFO] [table_restore.go:628] ["encode kv data and write completed"] [table=`emp`.`emp`] [engineNumber=0] [read=0] [written=1691332] [takeTime=1.45991908s] []
[2023/03/30 17:11:29.528 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 17:11:29.528 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=585ns] []
[2023/03/30 17:11:29.528 +08:00] [INFO] [table_restore.go:326] ["restore engine completed"] [table=`emp`.`emp`] [engineNumber=0] [takeTime=1.460868367s] []
[2023/03/30 17:11:29.528 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 17:11:29.528 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0]
[2023/03/30 17:11:29.528 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [retryCnt=0] [takeTime=779ns] []
[2023/03/30 17:11:29.528 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4]
[2023/03/30 17:11:29.529 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=272ns] []
[2023/03/30 17:11:29.529 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:0] [engineUUID=b4f4cfbb-5d47-5014-8ade-123babbcdac4] [takeTime=298.062µs] []
[2023/03/30 17:11:29.529 +08:00] [INFO] [table_restore.go:352] ["import whole table completed"] [table=`emp`.`emp`] [takeTime=1.461279415s] []
[2023/03/30 17:11:29.529 +08:00] [INFO] [backend.go:462] ["engine close start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 17:11:29.529 +08:00] [INFO] [backend.go:464] ["engine close completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=196ns] []
[2023/03/30 17:11:29.529 +08:00] [INFO] [table_restore.go:990] ["import and cleanup engine start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 17:11:29.529 +08:00] [INFO] [backend.go:476] ["import start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0]
[2023/03/30 17:11:29.529 +08:00] [INFO] [backend.go:479] ["import completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [retryCnt=0] [takeTime=426ns] []
[2023/03/30 17:11:29.529 +08:00] [INFO] [backend.go:491] ["cleanup start"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda]
[2023/03/30 17:11:29.529 +08:00] [INFO] [backend.go:493] ["cleanup completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=300ns] []
[2023/03/30 17:11:29.529 +08:00] [INFO] [table_restore.go:1020] ["import and cleanup engine completed"] [engineTag=`emp`.`emp`:-1] [engineUUID=e43634b2-152b-5bb0-8dca-9ca021fb1fda] [takeTime=450.273µs] []
[2023/03/30 17:11:29.530 +08:00] [INFO] [restore.go:1584] ["restore table completed"] [table=`emp`.`emp`] [takeTime=1.463776s] []
[2023/03/30 17:11:29.530 +08:00] [INFO] [restore.go:1330] ["cancel periodic actions"] [do=false]
[2023/03/30 17:11:29.530 +08:00] [INFO] [restore.go:1553] ["restore all tables data completed"] [takeTime=1.464044741s] []
[2023/03/30 17:11:29.530 +08:00] [INFO] [restore.go:1850] ["skip full compaction"]
[2023/03/30 17:11:29.530 +08:00] [INFO] [restore.go:2039] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=1680167486468049000]
[2023/03/30 17:11:29.530 +08:00] [INFO] [restore.go:2047] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=1680167486468049000] [takeTime=105.637µs] []
[2023/03/30 17:11:29.530 +08:00] [INFO] [restore.go:496] ["the whole procedure completed"] [takeTime=3.052376362s] []
[2023/03/30 17:11:29.531 +08:00] [INFO] [main.go:106] ["tidb lightning exit"] [finished=true]